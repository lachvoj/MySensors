/*
 * The MySensors Arduino library handles the wireless radio link and protocol
 * between your home built sensors/actuators and HA controller of choice.
 * The sensors forms a self healing radio network with optional repeaters. Each
 * repeater and gateway builds a routing tables in EEPROM which keeps track of the
 * network topology allowing messages to be routed to nodes.
 *
 * Created by Henrik Ekblad <henrik.ekblad@mysensors.org>
 * Copyright (C) 2013-2020 Sensnology AB
 * Full contributor list: https://github.com/mysensors/MySensors/graphs/contributors
 *
 * Documentation: http://www.mysensors.org
 * Support Forum: http://forum.mysensors.org
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * version 2 as published by the Free Software Foundation.
 *
 * Based on Mike McCauley's RFM95 library, Copyright (C) 2014 Mike McCauley <mikem@airspayce.com>
 * Radiohead http://www.airspayce.com/mikem/arduino/RadioHead/index.html
 *
 * RFM95 driver refactored and optimized for MySensors, Copyright (C) 2017-2019 Olivier Mauti <olivier@mysensors.org>
 * RFM69 compatibility mode, Copyright (C) 2019 Olivier Mauti <olivier@mysensors.org>
 *
 * Definitions for HopeRF LoRa radios:
 * https://www.hoperf.com/data/upload/portal/20190611/RFM95W-V1.1.pdf
 *
 */

// Register access
#define RFM95_READ_REGISTER								0x7f	//!< reading register
#define RFM95_WRITE_REGISTER							0x80	//!< writing register
#define RFM95_NOP													0x00	//!< NOP

// Common registers, OOK / FSK & LORA modes
#define RFM95_REG_00_FIFO									0x00 //!< REG_00_FIFO
#define RFM95_REG_01_OP_MODE							0x01 //!< REG_01_OP_MODE
#define RFM95_REG_06_FRF_MSB							0x06 //!< REG_06_FRF_MSB
#define RFM95_REG_07_FRF_MID							0x07 //!< REG_07_FRF_MID
#define RFM95_REG_08_FRF_LSB							0x08 //!< REG_08_FRF_LSB
#define RFM95_REG_09_PA_CONFIG						0x09 //!< REG_09_PA_CONFIG
#define RFM95_REG_0A_PA_RAMP							0x0a //!< REG_0A_PA_RAMP
#define RFM95_REG_0B_OCP									0x0b //!< REG_0B_OCP
#define RFM95_REG_0C_LNA									0x0c //!< REG_0C_LNA
#define RFM95_REG_40_DIO_MAPPING1					0x40 //!< REG_40_DIO_MAPPING1
#define RFM95_REG_41_DIO_MAPPING2					0x41 //!< REG_41_DIO_MAPPING2
#define RFM95_REG_42_VERSION							0x42 //!< REG_42_VERSION
#define RFM95_REG_4B_TCXO									0x4b //!< REG_4B_TCXO
#define RFM95_REG_4D_PA_DAC								0x4d //!< REG_4D_PA_DAC
#define RFM95_REG_5B_FORMER_TEMP					0x5b //!< REG_5B_FORMER_TEMP
#define RFM95_REG_61_AGC_REF							0x61 //!< REG_61_AGC_REF
#define RFM95_REG_62_AGC_THRESH1					0x62 //!< REG_62_AGC_THRESH1
#define RFM95_REG_63_AGC_THRESH2					0x63 //!< REG_63_AGC_THRESH2
#define RFM95_REG_64_AGC_THRESH3					0x64 //!< REG_64_AGC_THRESH3

// FSK / OOK mode registers
#define RFM95_REG_02_BITRATE_MSB					0x02 //!< RFM95_REG_02_BITRATE_MSB
#define RFM95_REG_03_BITRATE_LSB					0x03 //!< RFM95_REG_03_BITRATE_LSB
#define RFM95_REG_04_FDEV_MSB							0x04 //!< RFM95_REG_04_FDEV_MSB
#define RFM95_REG_05_FDEV_LSB							0x05 //!< RFM95_REG_05_FDEV_LSB
#define RFM95_REG_0D_RX_CONFIG						0x0d //!< RFM95_REG_0D_RX_CONFIG
#define RFM95_REG_0E_RSSI_CONFIG					0x0e //!< RFM95_REG_0E_RSSI_CONFIG
#define RFM95_REG_0F_RSSI_COLLISION				0x0f //!< RFM95_REG_0F_RSSI_COLLISION
#define RFM95_REG_10_RSSI_THRESHOLD				0x10 //!< RFM95_REG_10_RSSI_THRESHOLD
#define RFM95_REG_11_RSSI_VALUE						0x11 //!< REG_11_RSSI_VALUE
#define RFM95_REG_12_RXBW									0x12 //!< RFM95_REG_12_RXBW
#define RFM95_REG_13_AFCBW								0x13 //!< RFM95_REG_13_AFCBW
#define RFM95_REG_14_OOK_PEAK							0x14 //!< RFM95_REG_14_OOK_PEAK
#define RFM95_REG_15_OOK_FIX							0x15 //!< RFM95_REG_15_OOK_FIX
#define RFM95_REG_16_OOK_AVG							0x16 //!< RFM95_REG_16_OOK_AVG
#define RFM95_REG_1A_AFCFEI								0x1a //!< RFM95_REG_1A_AFCFEI
#define RFM95_REG_1B_AFC_MSB							0x1b //!< RFM95_REG_1B_AFC_MSB
#define RFM95_REG_1C_AFC_LSB							0x1c //!< RFM95_REG_1C_AFC_LSB
#define RFM95_REG_1D_FEI_MSB							0x1d //!< RFM95_REG_1D_FEI_MSB
#define RFM95_REG_1E_FEI_LSB							0x1e //!< RFM95_REG_1E_FEI_LSB
#define RFM95_REG_1F_PREAMBLEDETECT				0x1f //!< REG_1F_SYMB_TIMEOUT_LSB
#define RFM95_REG_20_RX_TIMEOUT1					0x20 //!< RFM95_REG_20_RX_TIMEOUT1
#define RFM95_REG_21_RX_TIMEOUT2					0x21 //!< RFM95_REG_21_RX_TIMEOUT2
#define RFM95_REG_22_RX_TIMEOUT3					0x22 //!< RFM95_REG_22_RX_TIMEOUT3
#define RFM95_REG_23_RX_DELAY							0x23 //!< RFM95_REG_23_RX_DELAY
#define RFM95_REG_24_OSC									0x24 //!< RFM95_REG_24_OSC
#define RFM95_REG_25_PREAMBLE_MSB					0x25 //!< RFM95_REG_25_PREAMBLE_MSB
#define RFM95_REG_26_PREAMBLE_LSB					0x26 //!< RFM95_REG_26_PREAMBLE_LSB
#define RFM95_REG_27_SYNC_CONFIG					0x27 //!< REG_27_SYNC_CONFIG
#define RFM95_REG_28_SYNC_VALUE1					0x28 //!< RFM95_REG_28_SYNC_VALUE1
#define RFM95_REG_29_SYNC_VALUE2					0x29 //!< RFM95_REG_29_SYNC_VALUE2
#define RFM95_REG_2A_SYNC_VALUE3					0x2A //!< RFM95_REG_2A_SYNC_VALUE3
#define RFM95_REG_2B_SYNC_VALUE4					0x2B //!< RFM95_REG_2B_SYNC_VALUE4
#define RFM95_REG_2C_SYNC_VALUE5					0x2C //!< RFM95_REG_2C_SYNC_VALUE5
#define RFM95_REG_2D_SYNC_VALUE6					0x2D //!< RFM95_REG_2D_SYNC_VALUE6
#define RFM95_REG_2E_SYNC_VALUE7					0x2E //!< RFM95_REG_2E_SYNC_VALUE7
#define RFM95_REG_2F_SYNC_VALUE8					0x2F //!< RFM95_REG_2F_SYNC_VALUE8
#define RFM95_REG_30_PACKET_CONFIG1				0x30 //!< RFM95_REG_30_PACKET_CONFIG1
#define RFM95_REG_31_PACKET_CONFIG2				0x31 //!< RFM95_REG_30_PACKET_CONFIG2
#define RFM95_REG_32_PAYLOAD_LENGTH				0x33 //!< RFM95_REG_32_PAYLOAD_LENGTH
#define RFM95_REG_33_NODE_ADDR						0x33 //!< RFM95_REG_33_NODE_ADDR
#define RFM95_REG_34_BROADCAST_ADDR				0x34 //!< RFM95_REG_34_BROADCAST_ADDR
#define RFM95_REG_35_FIFO_THRESHOLD				0x35 //!< RFM95_REG_35_FIFO_THRESHOLD
#define RFM95_REG_36_SEQ_CONFIG1					0x36 //!< RFM95_REG_36_SEQ_CONFIG1
#define RFM95_REG_37_SEQ_CONFIG2					0x37 //!< RFM95_REG_37_SEQ_CONFIG2
#define RFM95_REG_38_TIMER_RESOL					0x38 //!< RFM95_REG_38_TIMER_RESOL
#define RFM95_REG_39_TIMER1_COEF					0x39 //!< RFM95_REG_39_TIMER1_COEF
#define RFM95_REG_3A_TIMER2_COEF					0x3A //!< RFM95_REG_3A_TIMER2_COEF
#define RFM95_REG_3B_IMAGECAL							0x3B //!< RFM95_REG_3B_IMAGECAL
#define RFM95_REG_3C_TEMP									0x3C //!< RFM95_REG_3C_TEMP
#define RFM95_REG_3D_LOW_BAT							0x3D //!< RFM95_REG_3D_LOW_BAT
#define RFM95_REG_3E_IRQ_FLAGS1						0x3E //!< RFM95_REG_3E_IRQ_FLAGS1
#define RFM95_REG_3F_IRQ_FLAGS2						0x3F //!< RFM95_REG_3F_IRQ_FLAGS2
#define RFM95_REG_44_PLL_HOP							0x44 //!< RFM95_REG_44_PLL_HOP
#define RFM95_REG_5D_BIT_RATE_FRAC				0x5D //!< RFM95_REG_5D_BIT_RATE_FRAC

// LORA mode registers
#define RFM95_REG_0D_FIFO_ADDR_PTR				0x0d //!< REG_0D_FIFO_ADDR_PTR
#define RFM95_REG_0E_FIFO_TX_BASE_ADDR		0x0e //!< REG_0E_FIFO_TX_BASE_ADDR
#define RFM95_REG_0F_FIFO_RX_BASE_ADDR		0x0f //!< REG_0F_FIFO_RX_BASE_ADDR
#define RFM95_REG_10_FIFO_RX_CURRENT_ADDR	0x10 //!< REG_10_FIFO_RX_CURRENT_ADDR
#define RFM95_REG_11_IRQ_FLAGS_MASK				0x11 //!< REG_11_IRQ_FLAGS_MASK
#define RFM95_REG_12_IRQ_FLAGS						0x12 //!< REG_12_IRQ_FLAGS
#define RFM95_REG_13_RX_NB_BYTES					0x13 //!< REG_13_RX_NB_BYTES
#define RFM95_REG_14_RX_HEADER_CNT_VALUE_MSB	0x14 //!< REG_14_RX_HEADER_CNT_VALUE_MSB
#define RFM95_REG_15_RX_HEADER_CNT_VALUE_LSB	0x15 //!< REG_15_RX_HEADER_CNT_VALUE_LSB
#define RFM95_REG_16_RX_PACKET_CNT_VALUE_MSB	0x16 //!< REG_16_RX_PACKET_CNT_VALUE_MSB
#define RFM95_REG_17_RX_PACKET_CNT_VALUE_LSB	0x17 //!< REG_17_RX_PACKET_CNT_VALUE_LSB
#define RFM95_REG_18_MODEM_STAT						0x18 //!< REG_18_MODEM_STAT
#define RFM95_REG_19_PKT_SNR_VALUE				0x19 //!< REG_19_PKT_SNR_VALUE
#define RFM95_REG_1A_PKT_RSSI_VALUE				0x1a //!< REG_1A_PKT_RSSI_VALUE
#define RFM95_REG_1B_RSSI_VALUE						0x1b //!< REG_1B_RSSI_VALUE
#define RFM95_REG_1C_HOP_CHANNEL					0x1c //!< REG_1C_HOP_CHANNEL
#define RFM95_REG_1D_MODEM_CONFIG1				0x1d //!< REG_1D_MODEM_CONFIG1
#define RFM95_REG_1E_MODEM_CONFIG2				0x1e //!< REG_1E_MODEM_CONFIG2
#define RFM95_REG_1F_SYMB_TIMEOUT_LSB			0x1f //!< REG_1F_SYMB_TIMEOUT_LSB
#define RFM95_REG_20_PREAMBLE_MSB					0x20 //!< REG_20_PREAMBLE_MSB
#define RFM95_REG_21_PREAMBLE_LSB					0x21 //!< REG_21_PREAMBLE_LSB
#define RFM95_REG_22_PAYLOAD_LENGTH				0x22 //!< REG_22_PAYLOAD_LENGTH
#define RFM95_REG_23_MAX_PAYLOAD_LENGTH		0x23 //!< REG_23_MAX_PAYLOAD_LENGTH
#define RFM95_REG_24_HOP_PERIOD						0x24 //!< REG_24_HOP_PERIOD
#define RFM95_REG_25_FIFO_RX_BYTE_ADDR		0x25 //!< REG_25_FIFO_RX_BYTE_ADDR
#define RFM95_REG_26_MODEM_CONFIG3				0x26 //!< REG_26_MODEM_CONFIG3


// RFM95_REG_01_OP_MODE
#define RFM95_MODULATION_FSK				0x00 //!< RFM95_MODULATION_FSK
#define RFM95_MODULATION_OOK				0x20 //!< RFM95_MODULATION_OOK

#define RFM95_LORA_MODE							0x80 //!< RFM95_LORA_MODE
#define RFM95_FSK_OOK_MODE					0x00 //!< RFM95_FSK_OOK_MODE

#define RFM95_HIGH_FREQUENCY_REG		0x00 //!< RFM95_HIGH_FREQUENCY_REG
#define RFM95_LOW_FREQUENCY_REG			0x08 //!< RFM95_LOW_FREQUENCY_REG

#define RFM95_MODE_SLEEP						0x00 //!< RFM95_MODE_SLEEP
#define RFM95_MODE_STDBY						0x01 //!< RFM95_MODE_STDBY
#define RFM95_MODE_SYNTHESIZER_TX		0x02 //!< RFM95_MODE_SYNTHESIZER_TX
#define RFM95_MODE_TX								0x03 //!< RFM95_MODE_TX
#define RFM95_MODE_SYNTHESIZER_RX		0x04 //!< RFM95_MODE_SYNTHESIZER_RX
#define RFM95_MODE_RX								0x05 //!< RFM95_MODE_RX 
#define RFM95_MODE_RXSINGLE					0x06 //!< RFM95_MODE_RXSINGLE
#define RFM95_MODE_CAD							0x07 //!< RFM95_MODE_CAD

// REG_02_BIT_RATE_MSB
#define RFM95_BITRATEMSB_55555			0x02

// REG_03_BIT_RATE_LSB
#define RFM95_BITRATELSB_55555			0x40

// REG_04_FDEV_MSB
#define RFM95_FDEVMSB_50000					0x03

// REG_04_FDEV_LSB
#define RFM95_FDEVLSB_50000					0x33

// RFM95_REG_0C_LNA
#define RFM95_LNA_GAIN_MASK					0x1F
#define RFM95_LNA_GAIN_G1						0x20  // Default
#define RFM95_LNA_GAIN_G2						0x40
#define RFM95_LNA_GAIN_G3						0x60
#define RFM95_LNA_GAIN_G4						0x80
#define RFM95_LNA_GAIN_G5						0xA0
#define RFM95_LNA_GAIN_G6						0xC0

#define RFM95_LNA_BOOST_MASK				0xFC
#define RFM95_LNA_BOOST_OFF					0x00 // Default
#define RFM95_LNA_BOOST_ON					0x03

// RFM95_REG_1D_RX_CONFIG
#define RFM95_RX_CONFIG_RESTARTRX_ON_COLLISION_ON				0x80
#define RFM95_RX_CONFIG_RESTARTRX_ON_COLLISION_OFF			0x00 // Default
#define RFM95_RX_CONFIG_RESTARTRX_WITHOUT_PLLLOCK				0x40 // Write only
#define RFM95_RX_CONFIG_RESTARTRX_WITH_PLLLOCK					0x20 // Write only
#define RFM95_RX_CONFIG_AFCAUTO_ON											0x10
#define RFM95_RX_CONFIG_AFCAUTO_OFF											0x00 // Default 
#define RFM95_RX_CONFIG_AGCAUTO_ON											0x08 // Default
#define RFM95_RX_CONFIG_AGCAUTO_OFF											0x00
#define RFM95_RX_CONFIG_RXTRIGGER_OFF										0x00
#define RFM95_RX_CONFIG_RXTRIGGER_RSSI										0x01
#define RFM95_RX_CONFIG_RXTRIGGER_PREAMBLEDETECT					0x06 // Default
#define RFM95_RX_CONFIG_RXTRIGGER_RSSI_PREAMBLEDETECT		0x07

// RFM95_REG_1E_RSSI_CONFIG
#define RFM95_RSSI_CONFIG_OFFSET_MASK                   0x07
#define RFM95_RSSI_CONFIG_OFFSET_P_00_DB                0x00  // Default
#define RFM95_RSSI_CONFIG_OFFSET_P_01_DB                0x08
#define RFM95_RSSI_CONFIG_OFFSET_P_02_DB                0x10
#define RFM95_RSSI_CONFIG_OFFSET_P_03_DB                0x18
#define RFM95_RSSI_CONFIG_OFFSET_P_04_DB                0x20
#define RFM95_RSSI_CONFIG_OFFSET_P_05_DB                0x28
#define RFM95_RSSI_CONFIG_OFFSET_P_06_DB                0x30
#define RFM95_RSSI_CONFIG_OFFSET_P_07_DB                0x38
#define RFM95_RSSI_CONFIG_OFFSET_P_08_DB                0x40
#define RFM95_RSSI_CONFIG_OFFSET_P_09_DB                0x48
#define RFM95_RSSI_CONFIG_OFFSET_P_10_DB                0x50
#define RFM95_RSSI_CONFIG_OFFSET_P_11_DB                0x58
#define RFM95_RSSI_CONFIG_OFFSET_P_12_DB                0x60
#define RFM95_RSSI_CONFIG_OFFSET_P_13_DB                0x68
#define RFM95_RSSI_CONFIG_OFFSET_P_14_DB                0x70
#define RFM95_RSSI_CONFIG_OFFSET_P_15_DB                0x78
#define RFM95_RSSI_CONFIG_OFFSET_M_16_DB                0x80
#define RFM95_RSSI_CONFIG_OFFSET_M_15_DB                0x88
#define RFM95_RSSI_CONFIG_OFFSET_M_14_DB                0x90
#define RFM95_RSSI_CONFIG_OFFSET_M_13_DB                0x98
#define RFM95_RSSI_CONFIG_OFFSET_M_12_DB                0xA0
#define RFM95_RSSI_CONFIG_OFFSET_M_11_DB                0xA8
#define RFM95_RSSI_CONFIG_OFFSET_M_10_DB                0xB0
#define RFM95_RSSI_CONFIG_OFFSET_M_09_DB                0xB8
#define RFM95_RSSI_CONFIG_OFFSET_M_08_DB                0xC0
#define RFM95_RSSI_CONFIG_OFFSET_M_07_DB                0xC8
#define RFM95_RSSI_CONFIG_OFFSET_M_06_DB                0xD0
#define RFM95_RSSI_CONFIG_OFFSET_M_05_DB                0xD8
#define RFM95_RSSI_CONFIG_OFFSET_M_04_DB                0xE0
#define RFM95_RSSI_CONFIG_OFFSET_M_03_DB                0xE8
#define RFM95_RSSI_CONFIG_OFFSET_M_02_DB                0xF0
#define RFM95_RSSI_CONFIG_OFFSET_M_01_DB                0xF8

#define RFM95_RSSI_CONFIG_SMOOTHING_MASK                0xF8
#define RFM95_RSSI_CONFIG_SMOOTHING_2                   0x00
#define RFM95_RSSI_CONFIG_SMOOTHING_4                   0x01
#define RFM95_RSSI_CONFIG_SMOOTHING_8                   0x02  // Default
#define RFM95_RSSI_CONFIG_SMOOTHING_16                  0x03
#define RFM95_RSSI_CONFIG_SMOOTHING_32                  0x04
#define RFM95_RSSI_CONFIG_SMOOTHING_64                  0x05
#define RFM95_RSSI_CONFIG_SMOOTHING_128                 0x06
#define RFM95_RSSI_CONFIG_SMOOTHING_256                 0x07

// RFM95_REG_1A_AFCFEI
#define RFM95_AFCFEI_AGCSTART                          0x10
#define RFM95_AFCFEI_AFCCLEAR                          0x02
#define RFM95_AFCFEI_AFCAUTOCLEAR_ON                   0x01
#define RFM95_AFCFEI_AFCAUTOCLEAR_OFF                  0x00  // Default

// RFM95_REG_1E_MODEM_CONFIG2
#define RFM95_SPREADING_FACTOR_64CPS				0x60 //!< SPREADING_FACTOR_64CPS, SF6
#define RFM95_SPREADING_FACTOR_128CPS				0x70 //!< SPREADING_FACTOR_128CPS, SF7
#define RFM95_SPREADING_FACTOR_256CPS				0x80 //!< SPREADING_FACTOR_256CPS, SF8
#define RFM95_SPREADING_FACTOR_512CPS				0x90 //!< SPREADING_FACTOR_512CPS, SF9
#define RFM95_SPREADING_FACTOR_1024CPS			0xA0 //!< SPREADING_FACTOR_1024CPS, SF10
#define RFM95_SPREADING_FACTOR_2048CPS			0xB0 //!< SPREADING_FACTOR_2048CPS, SF11
#define RFM95_SPREADING_FACTOR_4096CPS			0xC0 //!< SPREADING_FACTOR_4096CPS, SF12

#define RFM95_SYM_TIMEOUT_MSB								0x03 //!< SYM_TIMEOUT_MSB
#define RFM95_RX_PAYLOAD_CRC_ON							0x04 //!< RX_PAYLOAD_CRC_ON
#define RFM95_TX_CONTINUOUS_MOdE						0x08 //!< TX_CONTINUOUS_MODE

// RFM95_REG_24_OSC
#define RFM95_OSC_RCCALSTART                           0x08

#define RFM95_OSC_CLKOUT_MASK                          0xF8
#define RFM95_OSC_CLKOUT_32_MHZ                        0x00
#define RFM95_OSC_CLKOUT_16_MHZ                        0x01
#define RFM95_OSC_CLKOUT_8_MHZ                         0x02
#define RFM95_OSC_CLKOUT_4_MHZ                         0x03
#define RFM95_OSC_CLKOUT_2_MHZ                         0x04
#define RFM95_OSC_CLKOUT_1_MHZ                         0x05  // Default
#define RFM95_OSC_CLKOUT_RC                            0x06
#define RFM95_OSC_CLKOUT_OFF                           0x07

// RFM95_REG_26_MODEM_CONFIG3 0x26
#define RFM95_LOW_DATA_RATE_OPTIMIZE				0x08 //!< LOW_DATA_RATE_OPTIMIZE
#define RFM95_AGC_AUTO_ON										0x04 //!< AGC_AUTO_ON

// RFM95_REG_27_SYNC_CONFIG
#define RFM95_SYNC_AUTORXRESTART_OFF				0x00 //!< RFM95_SYNC_AUTORXRESTART_OFF
#define RFM95_SYNC_AUTORXRESTART_NO_PLL			0x40 //!< RFM95_SYNC_AUTORXRESTART_NO_PLL
#define RFM95_SYNC_AUTORXRESTART_WAIT_PLL		0x80 //!< RFM95_SYNC_AUTORXRESTART_WAIT_PLL

#define RFM95_SYNC_PREAMBLE_POLARITY_AA			0x00 //!< RFM95_SYNC_PREAMBLE_POLARITY_AA
#define RFM95_SYNC_PREAMBLE_POLARITY_55			0x20 //!< RFM95_SYNC_PREAMBLE_POLARITY_55

#define RFM95_SYNC_OFF											0x00 //!< RFM95_SYNC_OFF
#define RFM95_SYNC_ON												0x10 //!< RFM95_SYNC_ON

#define RFM95_SYNC_FIFO_FILL_AUTO						0x00 //!< RFM95_SYNC_FIFO_FILL_AUTO
#define RFM95_SYNC_FIFO_FILL_MANUAL					0x08 //!< RFM95_SYNC_FIFO_FILL_MANUAL

#define RFM95_SYNC_SIZE_1										0x00 //!< RFM95_SYNC_SIZE_1
#define RFM95_SYNC_SIZE_2										0x01 //!< RFM95_SYNC_SIZE_2
#define RFM95_SYNC_SIZE_3										0x02 //!< RFM95_SYNC_SIZE_3
#define RFM95_SYNC_SIZE_4										0x03 //!< RFM95_SYNC_SIZE_4
#define RFM95_SYNC_SIZE_5										0x04 //!< RFM95_SYNC_SIZE_5
#define RFM95_SYNC_SIZE_6										0x05 //!< RFM95_SYNC_SIZE_6
#define RFM95_SYNC_SIZE_7										0x06 //!< RFM95_SYNC_SIZE_7
#define RFM95_SYNC_SIZE_8										0x07 //!< RFM95_SYNC_SIZE_8

// RFM95_REG_30_PACKET_CONFIG1
#define RFM95_PACKET1_FORMAT_FIXED										0x00 //!< 
#define RFM95_PACKET1_FORMAT_VARIABLE									0x80 //!< 

#define RFM95_PACKET1_DCFREE_OFF											0x00 //!< 
#define RFM95_PACKET1_DCFREE_MANCHESTER								0x20 //!< 
#define RFM95_PACKET1_DCFREE_WHITENING								0x40 //!< 

#define RFM95_PACKET1_CRC_OFF													0x00 //!< 
#define RFM95_PACKET1_CRC_ON													0x10 //!< 

#define RFM95_PACKET1_CRCAUTOCLEAR_ON									0x00 //!< 
#define RFM95_PACKET1_CRCAUTOCLEAR_OFF								0x08 //!< 

#define RFM95_PACKET1_ADRSFILTERING_NONE							0x00 //!< 
#define RFM95_PACKET1_ADRSFILTERING_NODE							0x02 //!< 
#define RFM95_PACKET1_ADRSFILTERING_NODEBROADCAST			0x04 //!< 

#define RFM95_PACKET1_CRC_WHITENING_CCITT							0x00 //!< 
#define RFM95_PACKET1_CRC_WHITENING_IBM								0x01 //!< 


// RFM95_REG_31_PACKET_CONFIG2
#define RFM95_PACKET2_DATA_MODE_CONTINUOUS							0x00 //!< 
#define RFM95_PACKET2_DATA_MODE_PACKET									0x40 //!< 

#define RFM95_PACKET2_IOHOME_OFF												0x00 //!< 
#define RFM95_PACKET2_IOHOME_ON													0x20 //!< 

#define RFM95_PACKET2_IOHOME_POWER_FRAME_OFF						0x00 //!< 
#define RFM95_PACKET2_IOHOME_POWER_FRAME_ON							0x10 //!< 

#define RFM95_PACKET2_BEACON_OFF												0x00 //!< 
#define RFM95_PACKET2_BEACON_ON													0x08 //!< 

// RFM95_REG_35_FIFO_THRESHOLD
#define RFM95_TXSTART_CONDITION_FIFO_THRESHOLD					0x00 //!< 
#define RFM95_TXSTART_CONDITION_FIFO_NOT_EMPTY					0x80 //!< 

// RFM95_REG_36_SEQ_CONFIG1
#define RFM95_SEQ_CONFIG1_SEQUENCER_START               0x80 //!< 

#define RFM95_SEQ_CONFIG1_SEQUENCER_STOP                0x40 //!< 

#define RFM95_SEQ_CONFIG1_IDLEMODE_MASK                 0xDF //!< 
#define RFM95_SEQ_CONFIG1_IDLEMODE_SLEEP                0x20 //!< 
#define RFM95_SEQ_CONFIG1_IDLEMODE_STANDBY              0x00 //!< Default

#define RFM95_SEQ_CONFIG1_FROMSTART_MASK                0xE7 //!< 
#define RFM95_SEQ_CONFIG1_FROMSTART_TOLPS               0x00 //!< Default
#define RFM95_SEQ_CONFIG1_FROMSTART_TORX                0x08 //!< 
#define RFM95_SEQ_CONFIG1_FROMSTART_TOTX                0x10 //!< 
#define RFM95_SEQ_CONFIG1_FROMSTART_TOTX_ONFIFOLEVEL    0x18 //!< 

#define RFM95_SEQ_CONFIG1_LPS_MASK                      0xFB //!< 
#define RFM95_SEQ_CONFIG1_LPS_SEQUENCER_OFF             0x00 //!< Default
#define RFM95_SEQ_CONFIG1_LPS_IDLE                      0x04 //!< 

#define RFM95_SEQ_CONFIG1_FROMIDLE_MASK                 0xFD //!< 
#define RFM95_SEQ_CONFIG1_FROMIDLE_TOTX                 0x00 //!< Default
#define RFM95_SEQ_CONFIG1_FROMIDLE_TORX                 0x02 //!< 

#define RFM95_SEQ_CONFIG1_FROMTX_MASK                   0xFE //!< 
#define RFM95_SEQ_CONFIG1_FROMTX_TOLPS                  0x00 //!< Default
#define RFM95_SEQ_CONFIG1_FROMTX_TORX                   0x01 //!< 

// RFM95_REG_37_SEQ_CONFIG2
#define RFM95_SEQ_CONFIG2_FROMRX_MASK                   0x1F //!< 
#define RFM95_SEQ_CONFIG2_FROMRX_TOUNUSED_000           0x00 //!< Default
#define RFM95_SEQ_CONFIG2_FROMRX_TORXPKT_ONPLDRDY       0x20 //!< 
#define RFM95_SEQ_CONFIG2_FROMRX_TOLPS_ONPLDRDY         0x40 //!< 
#define RFM95_SEQ_CONFIG2_FROMRX_TORXPKT_ONCRCOK        0x60 //!< 
#define RFM95_SEQ_CONFIG2_FROMRX_TOSEQUENCEROFF_ONRSSI  0x80 //!< 
#define RFM95_SEQ_CONFIG2_FROMRX_TOSEQUENCEROFF_ONSYNC  0xA0 //!< 
#define RFM95_SEQ_CONFIG2_FROMRX_TOSEQUENCEROFF_ONPREAMBLE 0xC0 //!< 
#define RFM95_SEQ_CONFIG2_FROMRX_TOUNUSED_111           0xE0 //!< 

#define RFM95_SEQ_CONFIG2_FROMRXTIMEOUT_MASK            0xE7 //!< 
#define RFM95_SEQ_CONFIG2_FROMRXTIMEOUT_TORXRESTART     0x00 //!< Default
#define RFM95_SEQ_CONFIG2_FROMRXTIMEOUT_TOTX            0x08 //!< 
#define RFM95_SEQ_CONFIG2_FROMRXTIMEOUT_TOLPS           0x10 //!< 
#define RFM95_SEQ_CONFIG2_FROMRXTIMEOUT_TOSEQUENCEROFF  0x18 //!< 

#define RFM95_SEQ_CONFIG2_FROMRXPKT_MASK                0xF8 //!< 
#define RFM95_SEQ_CONFIG2_FROMRXPKT_TOSEQUENCEROFF      0x00 //!< Default
#define RFM95_SEQ_CONFIG2_FROMRXPKT_TOTX_ONFIFOEMPTY    0x01 //!< 
#define RFM95_SEQ_CONFIG2_FROMRXPKT_TOLPS               0x02 //!< 
#define RFM95_SEQ_CONFIG2_FROMRXPKT_TOSYNTHESIZERRX     0x03 //!< 
#define RFM95_SEQ_CONFIG2_FROMRXPKT_TORX                0x04 //!< 


// RFM95_REG_38_TIMER_RESOLUTION
#define RFM95_TIMER1_RESOL_MASK              0xF3 //!< 
#define RFM95_TIMER1_RESOL_OFF               0x00 //!< Default
#define RFM95_TIMER1_RESOL_000064_US         0x04 //!< 
#define RFM95_TIMER1_RESOL_004100_US         0x08 //!< 
#define RFM95_TIMER1_RESOL_262000_US         0x0C //!< 

#define RFM95_TIMER2_RESOL_MASK              0xFC //!< 
#define RFM95_TIMER2_RESOL_OFF               0x00 //!< Default
#define RFM95_TIMER2_RESOL_000064_US         0x01 //!< 
#define RFM95_TIMER2_RESOL_004100_US         0x02 //!< 
#define RFM95_TIMER2_RESOL_262000_US         0x03 //!< 

// RFM95_REG_39_TIMER1_COEFFICIENT
#define RFM95_TIMER1_COEFFICIENT             0xF5 //!< Default

// RFM95_REG_3A_TIMER2_COEFFICIENT
#define RFM95_TIMER2_COEFFICIENT             0x20 //!< Default

// RFM95_REG_3B_IMAGECAL
#define RFM95_IMAGECAL_AUTOIMAGECAL_MASK               0x7F
#define RFM95_IMAGECAL_AUTOIMAGECAL_ON                 0x80
#define RFM95_IMAGECAL_AUTOIMAGECAL_OFF                0x00  // Default

#define RFM95_IMAGECAL_IMAGECAL_MASK                   0xBF
#define RFM95_IMAGECAL_IMAGECAL_START                  0x40

#define RFM95_IMAGECAL_IMAGECAL_RUNNING                0x20
#define RFM95_IMAGECAL_IMAGECAL_DONE                   0x00  // Default

#define RFM95_IMAGECAL_TEMPCHANGE_HIGHER               0x08
#define RFM95_IMAGECAL_TEMPCHANGE_LOWER                0x00

#define RFM95_IMAGECAL_TEMPTHRESHOLD_MASK              0xF9
#define RFM95_IMAGECAL_TEMPTHRESHOLD_05                0x00
#define RFM95_IMAGECAL_TEMPTHRESHOLD_10                0x02  // Default
#define RFM95_IMAGECAL_TEMPTHRESHOLD_15                0x04
#define RFM95_IMAGECAL_TEMPTHRESHOLD_20                0x06

#define RFM95_IMAGECAL_TEMPMONITOR_MASK                0xFE
#define RFM95_IMAGECAL_TEMPMONITOR_ON                  0x00 // Default
#define RFM95_IMAGECAL_TEMPMONITOR_OFF                 0x01


// RFM95_REG_3E_IRQ_FLAGS1
#define RFM95_IRQ1_MODE_READY					0x80 //!< RFM95_IRQ1_MODE_READY
#define RFM95_IRQ1_RX_READY						0x40 //!< RFM95_IRQ1_RX_READY
#define	RFM95_IRQ1_TX_READY						0x20 //!< RFM95_IRQ1_TX_READY
#define RFM95_IRQ1_PLL_LOCK						0x10 //!< RFM95_IRQ1_PLL_LOCK
#define RFM95_IRQ1_RSSI								0x08 //!< RFM95_IRQ1_RSSI
#define RFM95_IRQ1_TIMEOUT						0x04 //!< RFM95_IRQ1_TIMEOUT
#define RFM95_IRQ1_PREAMBLE_DETECT		0x02 //!< RFM95_IRQ1_PREAMBLE_DETECT
#define RFM95_IRQ1_SYNC_ADDRESS_MATCH	0x01 //!< RFM95_IRQ1_SYNC_ADDRESS_MATCH

// RFM95_REG_3F_IRQ_FLAGS2
#define RFM95_IRQ2_FIFO_FULL				0x80 //!< RFM95_IRQ2_FIFO_FULL
#define RFM95_IRQ2_FIFO_EMTPY				0x40 //!< RFM95_IRQ2_FIFO_EMTPY
#define RFM95_IRQ2_FIFO_LEVEL				0x20 //!< RFM95_IRQ2_FIFO_LEVEL
#define RFM95_IRQ2_FIFO_OVERRUN			0x10 //!< RFM95_IRQ2_FIFO_OVERRUN
#define RFM95_IRQ2_PACKET_SENT			0x08 //!< RFM95_IRQ2_PACKET_SENT
#define RFM95_IRQ2_PAYLOAD_READY		0x04 //!< RFM95_IRQ2_PAYLOAD_READY
#define RFM95_IRQ2_CRC_OK						0x02 //!< RFM95_IRQ2_CRC_OK
#define RFM95_IRQ2_LOW_BAT					0x01 //!< RFM95_IRQ2_LOW_BAT


// RFM95_REG_40_DIOMAPPING1
#define RFM95_DIOMAPPING1_DIO0_00                      0x00  // Default
#define RFM95_DIOMAPPING1_DIO0_01                      0x40
#define RFM95_DIOMAPPING1_DIO0_10                      0x80
#define RFM95_DIOMAPPING1_DIO0_11                      0xC0

#define RFM95_DIOMAPPING1_DIO1_MASK                    0xCF
#define RFM95_DIOMAPPING1_DIO1_00                      0x00  // Default
#define RFM95_DIOMAPPING1_DIO1_01                      0x10
#define RFM95_DIOMAPPING1_DIO1_10                      0x20
#define RFM95_DIOMAPPING1_DIO1_11                      0x30

#define RFM95_DIOMAPPING1_DIO2_MASK                    0xF3
#define RFM95_DIOMAPPING1_DIO2_00                      0x00  // Default
#define RFM95_DIOMAPPING1_DIO2_01                      0x04
#define RFM95_DIOMAPPING1_DIO2_10                      0x08
#define RFM95_DIOMAPPING1_DIO2_11                      0x0C

#define RFM95_DIOMAPPING1_DIO3_MASK                    0xFC
#define RFM95_DIOMAPPING1_DIO3_00                      0x00  // Default
#define RFM95_DIOMAPPING1_DIO3_01                      0x01
#define RFM95_DIOMAPPING1_DIO3_10                      0x02
#define RFM95_DIOMAPPING1_DIO3_11                      0x03

// RFM95_REG_41_DIOMAPPING2
#define RFM95_DIOMAPPING2_DIO4_MASK                    0x3F
#define RFM95_DIOMAPPING2_DIO4_00                      0x00  // Default
#define RFM95_DIOMAPPING2_DIO4_01                      0x40
#define RFM95_DIOMAPPING2_DIO4_10                      0x80
#define RFM95_DIOMAPPING2_DIO4_11                      0xC0

#define RFM95_DIOMAPPING2_DIO5_MASK                    0xCF
#define RFM95_DIOMAPPING2_DIO5_00                      0x00  // Default
#define RFM95_DIOMAPPING2_DIO5_01                      0x10
#define RFM95_DIOMAPPING2_DIO5_10                      0x20
#define RFM95_DIOMAPPING2_DIO5_11                      0x30

// RFM95_REG_4B_TCXO 0x4b
#define RFM95_TCXO_TCXO_INPUT_ON			0x10 //!< TCXO_TCXO_INPUT_ON

// RFM95_REG_4D_PA_DAC 0x4d
#define RFM95_PA_DAC_DISABLE					0x04 //!< PA_DAC_DISABLE
#define RFM95_PA_DAC_ENABLE						0x07 //!< PA_DAC_ENABLE

// REG_25_PREAMBLE_MSB
#define RFM95_PREAMBLESIZE_MSB_VALUE			0x00  // Default

// REG_26_PREAMBLE_LSB
#define RFM95_PREAMBLESIZE_LSB_VALUE			0x03  // Default

// REG_12_RXBW
#define RFM95_RXBW_MANT_16               0x00 // 0b00000 
#define RFM95_RXBW_MANT_20               0x08 // 0b01000 
#define RFM95_RXBW_MANT_24               0x10 // 0b10000
#define RFM95_RXBW_EXP_7                 0x07
#define RFM95_RXBW_EXP_6                 0x06
#define RFM95_RXBW_EXP_5                 0x05
#define RFM95_RXBW_EXP_4                 0x04
#define RFM95_RXBW_EXP_3                 0x03
#define RFM95_RXBW_EXP_2                 0x02
#define RFM95_RXBW_EXP_1                 0x01

// RFM95_REG_09_PA_CONFIG 0x09
#define RFM95_OUTPUT_POWER						0x0F //!< OUTPUT_POWER
#define RFM95_MAX_POWER							0x70 //!< MAX_POWER
#define RFM95_PA_SELECT							0x80 //!< PA_SELECT

// RFM95_REG_0A_PA_RAMP 0x0a
#define RFM95_PA_RAMP_3_4MS						0x00 //!< PA_RAMP_3_4MS
#define RFM95_PA_RAMP_2MS						0x01 //!< PA_RAMP_2MS
#define RFM95_PA_RAMP_1MS						0x02 //!< PA_RAMP_1MS
#define RFM95_PA_RAMP_500US						0x03 //!< PA_RAMP_500US
#define RFM95_PA_RAMP_250US						0x04 //!< PA_RAMP_250US
#define RFM95_PA_RAMP_125US						0x05 //!< PA_RAMP_125US
#define RFM95_PA_RAMP_100US						0x06 //!< PA_RAMP_100US
#define RFM95_PA_RAMP_62US						0x07 //!< PA_RAMP_62US
#define RFM95_PA_RAMP_50US						0x08 //!< PA_RAMP_50US
#define RFM95_PA_RAMP_40US						0x09 //!< PA_RAMP_40US
#define RFM95_PA_RAMP_31US						0x0A //!< PA_RAMP_31US
#define RFM95_PA_RAMP_25US						0x0B //!< PA_RAMP_25US
#define RFM95_PA_RAMP_20US						0x0C //!< PA_RAMP_20US
#define RFM95_PA_RAMP_15US						0x0D //!< PA_RAMP_15US
#define RFM95_PA_RAMP_12US						0x0E //!< PA_RAMP_12US
#define RFM95_PA_RAMP_10US						0x0F //!< PA_RAMP_10US
#define RFM95_LOW_PN_TX_PLL_OFF					0x10 //!< LOW_PN_TX_PLL_OFF

// RFM95_REG_0B_OCP 0x0b
#define RFM95_OCP_TRIM							0x1f //!< OCP_TRIM
#define RFM95_OCP_ON							0x20 //!< OCP_ON

// RFM95_REG_0C_LNA 0x0c
#define RFM95_LNA_BOOST_DEFAULT					0x20 //!< LNA_BOOST_DEFAULT
#define RFM95_LNA_BOOST							0x03 //!< LNA_BOOST

// RFM95_REG_11_IRQ_FLAGS_MASK 0x11
#define RFM95_CAD_DETECTED_MASK					0x01 //!< CAD_DETECTED_MASK
#define RFM95_FHSS_CHANGE_CHANNEL_MASK			0x02 //!< FHSS_CHANGE_CHANNEL_MASK
#define RFM95_CAD_DONE_MASK						0x04 //!< CAD_DONE_MASK
#define RFM95_TX_DONE_MASK						0x08 //!< TX_DONE_MASK
#define RFM95_VALID_HEADER_MASK					0x10 //!< VALID_HEADER_MASK
#define RFM95_PAYLOAD_CRC_ERROR_MASK			0x20 //!< PAYLOAD_CRC_ERROR_MASK
#define RFM95_RX_DONE_MASK						0x40 //!< RX_DONE_MASK
#define RFM95_RX_TIMEOUT_MASK					0x80 //!< RX_TIMEOUT_MASK

// RFM95_REG_12_IRQ_FLAGS 0x12
#define RFM95_CAD_DETECTED						0x01 //!< CAD_DETECTED
#define RFM95_FHSS_CHANGE_CHANNEL				0x02 //!< FHSS_CHANGE_CHANNEL
#define RFM95_CAD_DONE							0x04 //!< CAD_DONE
#define RFM95_TX_DONE							0x08 //!< TX_DONE
#define RFM95_VALID_HEADER						0x10 //!< VALID_HEADER
#define RFM95_PAYLOAD_CRC_ERROR					0x20 //!< PAYLOAD_CRC_ERROR
#define RFM95_RX_DONE							0x40 //!< RX_DONE
#define RFM95_RX_TIMEOUT						0x80 //!< RX_TIMEOUT
#define RFM95_CLEAR_IRQ							0xFF //<! Clear IRQ

// RFM95_REG_18_MODEM_STAT 0x18
#define RFM95_MODEM_STATUS_SIGNAL_DETECTED		0x01 //!< MODEM_STATUS_SIGNAL_DETECTED
#define RFM95_MODEM_STATUS_SIGNAL_SYNCHRONIZED	0x02 //!< MODEM_STATUS_SIGNAL_SYNCHRONIZED
#define RFM95_MODEM_STATUS_RX_ONGOING			0x04 //!< MODEM_STATUS_RX_ONGOING
#define RFM95_MODEM_STATUS_HEADER_INFO_VALID	0x08 //!< MODEM_STATUS_HEADER_INFO_VALID
#define RFM95_MODEM_STATUS_CLEAR				0x10 //!< MODEM_STATUS_CLEAR

// RFM95_REG_1C_HOP_CHANNEL 0x1c
#define RFM95_RX_PAYLOAD_CRC_IS_ON				0x40 //!< RX_PAYLOAD_CRC_IS_ON
#define RFM95_PLL_TIMEOUT						0x80 //!< PLL_TIMEOUT

// RFM95_REG_1D_MODEM_CONFIG1 0x1d

#define RFM95_BW_7_8KHZ							0x00 //!< BW_7_8KHZ	
#define RFM95_BW_10_4KHZ						0x10 //!< BW_10_4KHZ
#define RFM95_BW_15_6KHZ						0x20 //!< BW_15_6KHZ
#define RFM95_BW_20_8KHZ						0x30 //!< BW_20_8KHZ
#define RFM95_BW_31_25KHZ						0x40 //!< BW_31_25KHZ
#define RFM95_BW_41_7KHZ						0x50 //!< BW_41_7KHZ
#define RFM95_BW_62_5KHZ						0x60 //!< BW_62_5KHZ
#define RFM95_BW_125KHZ							0x70 //!< BW_125KHZ
#define RFM95_BW_250KHZ							0x80 //!< BW_250KHZ
#define RFM95_BW_500KHZ							0x90 //!< BW_500KHZ

#define RFM95_IMPLICIT_HEADER_MODE_ON			0x01 //!< IMPLICIT_HEADER_MODE_ON
#define RFM95_CODING_RATE_4_5					0x02 //!< CODING_RATE_4_5
#define RFM95_CODING_RATE_4_6					0x04 //!< CODING_RATE_4_6
#define RFM95_CODING_RATE_4_7					0x06 //!< CODING_RATE_4_7
#define RFM95_CODING_RATE_4_8					0x08 //!< CODING_RATE_4_8

// RFM95_REG_1E_MODEM_CONFIG2 0x1e
#define RFM95_SPREADING_FACTOR_64CPS			0x60 //!< SPREADING_FACTOR_64CPS, SF6
#define RFM95_SPREADING_FACTOR_128CPS			0x70 //!< SPREADING_FACTOR_128CPS, SF7
#define RFM95_SPREADING_FACTOR_256CPS			0x80 //!< SPREADING_FACTOR_256CPS, SF8
#define RFM95_SPREADING_FACTOR_512CPS			0x90 //!< SPREADING_FACTOR_512CPS, SF9
#define RFM95_SPREADING_FACTOR_1024CPS			0xA0 //!< SPREADING_FACTOR_1024CPS, SF10
#define RFM95_SPREADING_FACTOR_2048CPS			0xB0 //!< SPREADING_FACTOR_2048CPS, SF11
#define RFM95_SPREADING_FACTOR_4096CPS			0xC0 //!< SPREADING_FACTOR_4096CPS, SF12

#define RFM95_SYM_TIMEOUT_MSB					0x03 //!< SYM_TIMEOUT_MSB
#define RFM95_RX_PAYLOAD_CRC_ON					0x04 //!< RX_PAYLOAD_CRC_ON
#define RFM95_TX_CONTINUOUS_MOdE				0x08 //!< TX_CONTINUOUS_MODE

// RFM95_REG_26_MODEM_CONFIG3 0x26
#define RFM95_LOW_DATA_RATE_OPTIMIZE			0x08 //!< LOW_DATA_RATE_OPTIMIZE
#define RFM95_AGC_AUTO_ON						0x04 //!< AGC_AUTO_ON

// RFM95_REG_4B_TCXO 0x4b
#define RFM95_TCXO_INPUT_ON				0x10 //!< RFM95_TCXO_INPUT_ON

// RFM95_REG_4D_PA_DAC 0x4d
#define RFM95_PA_DAC_DISABLE					0x04 //!< PA_DAC_DISABLE
#define RFM95_PA_DAC_ENABLE						0x07 //!< PA_DAC_ENABLE
